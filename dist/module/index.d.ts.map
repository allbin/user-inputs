{"version":3,"sources":["../src/module/index.tsx"],"names":[],"mappings":"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","file":"index.d.ts","sourcesContent":["import * as React from 'react';\nimport oh from 'output-helpers';\nimport translations from './translations';\n\nimport formGenerator, { validateFormGeneratorInputs } from './formGenerator';\n\nimport PromptModal from './PromptModal';\nimport * as TextImport from './input_components/TextInput';\nimport * as BoolImport from './input_components/BoolInput';\nimport * as GridImport from './input_components/GridInput';\nimport * as SelectImport from './input_components/SelectInput';\nimport * as MultiSelectImport from './input_components/MultiSelectInput';\nimport * as TextareaImport from './input_components/TextareaInput';\nimport * as TriStateImport from './input_components/TriStateInput';\nimport * as NumericImport from './input_components/NumericInput';\nimport * as ButtonImport from './input_components/Button';\n\n\nexport let valid_types = [\"bool\", \"button\", \"confirm\", \"date\", \"grid\", \"numeric\", \"multi_select\", \"select\", \"text\", \"textarea\", \"tri_state\"];\n\n\n//Add translations of this repo to OH. Prefixed with \"user_input_\".\noh.addDictionary(translations);\n\n\n\n\n\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n\nexport interface LooseObject {\n    [key: string]: any;\n}\nexport interface SelectOption {\n    value: string | number;\n    label: string;\n}\nexport interface TriStateInputOption {\n    value: string | number;\n    label: string;\n}\nexport interface MultiSelectOption {\n    value: string | number;\n    label: string;\n}\nexport interface GridSelectOption {\n    value: string | number;\n    label: string;\n    color?: string;\n}\n\nexport interface GeneratedForm {\n    component: typeof React.Component;\n    reset: () => void;\n    resetConfirmClick: () => void;\n    getValues: () => LooseObject;\n    setInputConfig: (updated_config: AnyInputConfigWithValue) => void;\n}\n\nexport interface HOCProps {\n    /** Opens a prompt using supplied config which has a single Confirm button. */\n    alert: (prompt_request: UserInputPromptConfig, confirmCB?: (values: LooseObject) => void) => void;\n    /** Closes any open prompt without triggering any Confirm or Cancel callbacks. */\n    cancel: () => void;\n    /** Opens a prompt using supplied config which has a Confirm and Cancel button. */\n    confirm: (prompt_request: UserInputPromptConfig, confirmCB?: (values: LooseObject) => void, cancelCB?: () => void) => void;\n    /** Returns current tag. If no tag has been set returns null. */\n    getTag: () => string | null;\n    /** Returns true if a prompt is currently showing to the user. Otherwise false. */\n    isOpen: () => boolean;\n    /** Modify the config a currently open prompt. */\n    setConfig: (input_config: AnyInputConfigWithValue) => void;\n    /** Set tag. */\n    setTag: (tag: string) => void;\n}\n\nexport type UpdateConfig = {\n    key: string;\n    value?: any;\n};\nexport type AnyInputConfig = ButtonImport.ButtonConfig | TextImport.TextInputConfig | BoolImport.BoolInputConfig | GridImport.GridInputConfig | SelectImport.SelectInputConfig | MultiSelectImport.MultiSelectInputConfig | NumericImport.NumericInputConfig | TextareaImport.TextareaInputConfig | TriStateImport.TriStateInputConfig;\nexport type AnyInputConfigWithValue = Partial<AnyInputConfig> & UpdateConfig & Pick<AnyInputConfig, \"type\">;\nexport type PromptInputConfigArray = Array<ButtonImport.ButtonConfig | TextImport.TextInputConfig | BoolImport.BoolInputConfig | GridImport.GridInputConfig | SelectImport.SelectInputConfig | MultiSelectImport.MultiSelectInputConfig | NumericImport.NumericInputConfig | TextareaImport.TextareaInputConfig | TriStateImport.TriStateInputConfig>;\nexport type FormInputConfigArray = Array<ButtonImport.ButtonConfig | TextImport.TextInputConfig | BoolImport.BoolInputConfig | GridImport.GridInputConfig | SelectImport.SelectInputConfig | MultiSelectImport.MultiSelectInputConfig | NumericImport.NumericInputConfig | TextareaImport.TextareaInputConfig | TriStateImport.TriStateInputConfig>;\n\n\nexport interface PromptState {\n    prompt_config: PromptConfig | null;\n    tag: string | null;\n    form: GeneratedForm | null;\n}\n\nexport interface UserInputPromptConfig {\n    title: string;\n    inputs: PromptInputConfigArray;\n    message?: string;\n    classes?: string;\n    confirmCB?: () => void;\n    cancelCB?: () => void;\n    confirm_button_label?: string;\n    cancel_button_label?: string;\n}\n\nexport interface UserInputProps {\n    userInputs: HOCProps;\n}\n\nexport interface PromptConfig extends UserInputPromptConfig {\n    show_cancel_btn: boolean;\n    show_confirm_btn: boolean;\n}\n\ninterface InputComponentExports {\n    Input: React.ComponentClass<any>;\n    convertInternalToExternalValue: (cfg: any, value: any) => any;\n    validateConfig: (cfg: any) => null | string;\n    validate: (cfg: any, value: any) => null | string;\n    convertExternalToInternalValue: (cfg: any, value: any) => any;\n}\n\nexport interface ComponentObject {\n    [key: string]: InputComponentExports;\n    bool: InputComponentExports;\n    button: InputComponentExports;\n    date: InputComponentExports;\n    grid: InputComponentExports;\n    numeric: InputComponentExports;\n    select: InputComponentExports;\n    text: InputComponentExports;\n    textarea: InputComponentExports;\n    multi_select: InputComponentExports;\n    confirm: InputComponentExports;\n    tri_state: InputComponentExports;\n}\n\n\n\n\nexport const input_imports: ComponentObject = {\n    text: TextImport,\n    bool: BoolImport,\n    grid: GridImport,\n    button: ButtonImport,\n    select: SelectImport,\n    multi_select: MultiSelectImport,\n    textarea: TextareaImport,\n    tri_state: TriStateImport,\n    confirm: ButtonImport,\n    numeric: NumericImport,\n    date: TextImport\n};\n\n\n\n\nexport function renderPrompt(form: GeneratedForm | null, prompt_config: PromptConfig | null, userCancelledCB: () => void) {\n    if (!form || !prompt_config) {\n        return null;\n    }\n\n    return (\n        <PromptModal\n            cancelCB={() => { userCancelledCB(); }}\n            config={prompt_config}\n            form={form}\n        />\n    );\n}\n\n\n\nexport function InputHOC<P extends UserInputProps>(WrappedComponent: React.ComponentType<P>): React.ComponentClass<Omit<P, keyof UserInputProps>> {\n    class Prompt extends React.Component<P, PromptState> {\n        exports: HOCProps = {\n            confirm: (user_prompt_request, confirmCB, cancelCB) => {\n                if (user_prompt_request.hasOwnProperty(\"inputs\") === false) {\n                    user_prompt_request.inputs = [];\n                }\n                if (!user_prompt_request.title) {\n                    throw new Error(\"prompt_props requires 'title' property.\");\n                }\n                let default_settings = {\n                    show_cancel_btn: true,\n                    show_confirm_btn: true\n                };\n                let prompt_request: PromptConfig = Object.assign(\n                    {},\n                    user_prompt_request,\n                    default_settings\n                );\n                this.initPrompt(prompt_request, confirmCB, cancelCB);\n            },\n            alert: (user_prompt_request, confirmCB) => {\n                if (user_prompt_request.hasOwnProperty(\"inputs\") === false) {\n                    user_prompt_request.inputs = [];\n                }\n                if (!user_prompt_request.title) {\n                    throw new Error(\"prompt_props requires 'title' property.\");\n                }\n                let default_settings = {\n                    show_cancel_btn: false,\n                    show_confirm_btn: true\n                };\n                let prompt_request: PromptConfig = Object.assign(\n                    {},\n                    user_prompt_request,\n                    default_settings\n                );\n                this.initPrompt(prompt_request, confirmCB);\n            },\n            cancel: () => {\n                this.resetPrompt();\n            },\n            isOpen: () => {\n                return this.state.prompt_config !== null;\n            },\n            setTag: (tag) => {\n                this.setState({\n                    tag: tag\n                });\n            },\n            getTag: () => {\n                return this.state.tag;\n            },\n            setConfig: (input_config: AnyInputConfigWithValue) => {\n                if (this.state.form) {\n                    this.state.form.setInputConfig(input_config);\n                } else {\n                    throw new Error(\"UserInput: Cannot setConfig without an open prompt.\");\n                }\n            }\n        };\n\n        confirmCB: any = null;\n        cancelCB: any = null;\n\n        constructor(props: any) {\n            super(props);\n\n            this.state = {\n                prompt_config: null,\n                form: null,\n                tag: null\n            };\n        }\n\n        initPrompt(prompt_config: PromptConfig, confirmCB?: (value: any) => void, cancelCB?: () => void) {\n            let inputs = [...prompt_config.inputs];\n            let invalid_inputs = inputs.some(input => input.hasOwnProperty(\"default_value\") === false);\n            if (invalid_inputs) {\n                throw new Error(\"UserInput: Inputs must be configured with a 'default_value'.\");\n            }\n            invalid_inputs = inputs.some(input => !input_imports[input.type]);\n            if (invalid_inputs) {\n                throw new Error(\"UserInput: Inputs must be configured with a valid 'type'. \" + valid_types.join(','));\n            }\n            this.confirmCB = confirmCB || null;\n            this.cancelCB = cancelCB || null;\n\n            if (cancelCB) {\n                let cancel_config: ButtonImport.ButtonConfig = {\n                    label: prompt_config.confirm_button_label || oh.translate('user_input_cancel'),\n                    key: \"cancel\",\n                    type: \"button\",\n                    default_value: \"\",\n                    onClick: () => this.userCancelledCB(),\n                    filled: true,\n                    big: true\n                };\n                inputs.push(cancel_config);\n            }\n\n            let confirm_config: ButtonImport.ButtonConfig = {\n                label: prompt_config.confirm_button_label || oh.translate('user_input_confirm'),\n                key: \"confirm\",\n                type: \"confirm\",\n                default_value: \"\",\n                filled: true,\n                big: true\n            };\n            inputs.push(confirm_config);\n\n            this.setState({\n                form: formGenerator(inputs, (values: LooseObject) => this.userConfirmedCB(values)),\n                prompt_config: prompt_config\n            });\n        }\n\n        resetPrompt() {\n            this.confirmCB = null;\n            this.cancelCB = null;\n            this.setState({\n                form: null,\n                prompt_config: null,\n                tag: null\n            });\n        }\n\n        userConfirmedCB(values: LooseObject) {\n            //User clicked the confirm button.\n            if (this.confirmCB) {\n                this.confirmCB(values);\n            }\n            this.resetPrompt();\n        }\n        userCancelledCB() {\n            //User clicked the cancel button.\n            if (this.cancelCB) {\n                //Exec the cancelCB if one was supplied.\n                this.cancelCB();\n            }\n            this.resetPrompt();\n        }\n\n        render() {\n            return (<div>\n                <WrappedComponent userInputs={this.exports} {...this.props} />\n                {\n                    renderPrompt(\n                        this.state.form,\n                        this.state.prompt_config,\n                        () => { this.userCancelledCB(); }\n                    )\n                }\n            </div>);\n        }\n    }\n\n    return Prompt;\n}\n\n\nexport namespace InputHOC {\n    export function generateForm(input_configs: FormInputConfigArray, confirmCB?: (value: any) => void): GeneratedForm {\n        validateFormGeneratorInputs(input_configs, confirmCB);\n        return formGenerator(input_configs, confirmCB);\n    }\n}\n\nexport default InputHOC;\n"]}